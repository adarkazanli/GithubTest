<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Task Scheduler</title>
  <link rel="stylesheet" href="styles/main.css">
</head>
<body>
  <!-- Import Panel -->
  <section id="import-panel">
    <h1>Task Scheduler</h1>
    <div class="import-controls">
      <input type="file" id="excel-file" accept=".xlsx" />
      <button id="import-btn">Import Excel</button>
      <button id="reset-button" type="button" class="btn-reset" aria-label="Clear all application data">Reset All Data</button>
    </div>
    <div id="import-summary"></div>
    <div id="reset-messages" class="message-container" aria-live="polite"></div>
  </section>

  <!-- Schedule Controls -->
  <section id="schedule-controls">
    <label for="estimated-start-time">Estimated Start Time:</label>
    <input type="text" id="estimated-start-time" value="09:00" pattern="\d{2}:\d{2}" placeholder="HH:MM" />
    <button id="update-time-btn">Update Times</button>
    <button id="set-to-now-btn" type="button" aria-label="Set estimated start time to current time" aria-disabled="false">Set to Now</button>
  </section>

  <!-- Task List -->
  <section id="task-list">
    <!-- Tasks will be rendered here dynamically -->
  </section>

  <!-- Confirmation Dialog -->
  <div id="reset-dialog" class="dialog" role="dialog" aria-modal="true" aria-labelledby="dialog-title" hidden>
    <div class="dialog-backdrop"></div>
    <div class="dialog-content">
      <h2 id="dialog-title">Confirm Reset</h2>
      <p class="dialog-message">
        This will permanently delete all your task data and cannot be undone.
        Are you sure you want to continue?
      </p>
      <div class="dialog-actions">
        <button type="button" class="btn-secondary" id="dialog-cancel">Cancel</button>
        <button type="button" class="btn-danger" id="dialog-confirm">Delete All Data</button>
      </div>
    </div>
  </div>

  <!-- Load SheetJS (non-module script) -->
  <script src="assets/lib/xlsx.full.min.js"></script>

  <!-- Main application (ES6 module) -->
  <script type="module" src="src/main.js"></script>
</body>
</html>

